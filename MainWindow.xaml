<Window x:Class="FlugiClipboard.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="å‰ªè´´æ¿" Height="600" Width="480"
        WindowStartupLocation="Manual"
        ResizeMode="CanResize"
        Background="#F3F3F3"
        Topmost="True"
        ShowInTaskbar="False"
        WindowState="Normal"
        WindowStyle="None"
        AllowsTransparency="False"
        MinWidth="100"
        MinHeight="80">

    <Window.Resources>
        <!-- åœ†å½¢çª—å£æŽ§åˆ¶æŒ‰é’®æ ·å¼ -->
        <Style x:Key="CircleButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="16"/>
            <Setter Property="Height" Value="16"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Margin" Value="4,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Ellipse Fill="{TemplateBinding Background}"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ -->
        <Style x:Key="CustomScrollBarStyle" TargetType="ScrollBar">
            <Setter Property="Width" Value="3"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid>
                            <Border Background="Transparent"/>
                            <Track Name="PART_Track" IsDirectionReversed="True">
                                <Track.Thumb>
                                    <Thumb>
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <Border Background="#99999999"
                                                        CornerRadius="1.5"
                                                        Margin="0.5"/>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- å¡ç‰‡æ ·å¼ -->
        <Style x:Key="ClipboardCardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E1E1E1"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Margin" Value="8,4"/>
            <Setter Property="Padding" Value="12"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" Opacity="0.1"
                                      ShadowDepth="2" BlurRadius="4"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F8F8F8"/>
                    <Setter Property="BorderBrush" Value="#0078D4"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <!-- çª—å£è¾¹æ¡† - ç›´è§’è®¾è®¡ï¼Œç¡®ä¿æ ‡é¢˜æ å®Œç¾Žè´´åˆ -->
    <Border Background="White" BorderBrush="#E1E1E1" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- è‡ªå®šä¹‰æ ‡é¢˜æ  -->
            <Border Grid.Row="0" Background="White"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid Height="32">
                    <!-- çª—å£æ ‡é¢˜ -->
                    <TextBlock Text="å‰ªè´´æ¿" HorizontalAlignment="Center" VerticalAlignment="Center"
                               FontSize="14" Foreground="#323130" FontWeight="Medium"/>

                    <!-- çª—å£æŽ§åˆ¶æŒ‰é’® -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right"
                                VerticalAlignment="Center" Margin="0,0,12,0">
                        <Button Name="MinimizeButton" Style="{StaticResource CircleButtonStyle}"
                                Background="#FFBD2E" Click="MinimizeButton_Click" ToolTip="æœ€å°åŒ–"/>
                        <Button Name="MaximizeButton" Style="{StaticResource CircleButtonStyle}"
                                Background="#27CA3F" Click="MaximizeButton_Click" ToolTip="æœ€å¤§åŒ–"/>
                        <Button Name="CloseButton" Style="{StaticResource CircleButtonStyle}"
                                Background="#FF5F56" Click="CloseButton_Click" ToolTip="å…³é—­"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- åŠŸèƒ½æŒ‰é’®æ  -->
            <Border Grid.Row="1" Background="White" Padding="16,12"
                    BorderBrush="#E1E1E1" BorderThickness="0,0,0,1">
                <Grid>
                    <!-- å·¦ä¾§å›¾æ ‡ -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                        <Button Name="FolderButton" Content="ðŸ“"
                                Background="Transparent"
                                BorderThickness="0"
                                FontSize="14"
                                Padding="8,4"
                                Margin="0,0,8,0"
                                Click="FolderButton_Click"
                                ToolTip="æ‰“å¼€ç¨‹åºç›®å½•"/>
                    </StackPanel>

                    <!-- å³ä¾§å›¾æ ‡ -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Name="SettingsButton" Content="âš™ï¸"
                                Background="Transparent"
                                BorderThickness="0"
                                FontSize="14"
                                Padding="8,4"
                                Margin="0,0,8,0"
                                Click="SettingsButton_Click"
                                ToolTip="è®¾ç½®"/>
                        <Button Name="PinButton" Content="ðŸ“Œ"
                                Background="Transparent"
                                BorderThickness="0"
                                FontSize="14"
                                Padding="8,4"
                                Click="PinButton_Click"
                                ToolTip="ç½®é¡¶"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- ä¸»å†…å®¹åŒºåŸŸ - è¶…é«˜æ€§èƒ½æ»šåŠ¨ä¼˜åŒ– -->
            <ScrollViewer Grid.Row="2"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled"
                      Background="Transparent"
                      CanContentScroll="False"
                      PanningMode="VerticalOnly"
                      IsDeferredScrollingEnabled="False"
                      UseLayoutRounding="True"
                      SnapsToDevicePixels="True">
            <ScrollViewer.Resources>
                <Style TargetType="ScrollBar" BasedOn="{StaticResource CustomScrollBarStyle}"/>
            </ScrollViewer.Resources>

            <ListBox Name="ClipboardItemsControl"
                     Background="Transparent"
                     Margin="0,8"
                     BorderThickness="0"
                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                     ScrollViewer.VerticalScrollBarVisibility="Disabled"
                     ScrollViewer.CanContentScroll="False"
                     ScrollViewer.IsDeferredScrollingEnabled="False"
                     VirtualizingPanel.IsVirtualizing="True"
                     VirtualizingPanel.VirtualizationMode="Recycling"
                     VirtualizingPanel.ScrollUnit="Pixel"
                     VirtualizingPanel.CacheLengthUnit="Item"
                     VirtualizingPanel.CacheLength="30,30"
                     VirtualizingPanel.IsContainerVirtualizable="True"
                     UseLayoutRounding="True"
                     SnapsToDevicePixels="True">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <VirtualizingStackPanel/>
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                        <Setter Property="Padding" Value="0"/>
                        <Setter Property="Margin" Value="0"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListBoxItem">
                                    <ContentPresenter/>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListBox.ItemContainerStyle>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Border Style="{StaticResource ClipboardCardStyle}"
                                MouseLeftButtonDown="ClipboardItem_MouseLeftButtonDown">
                            <Border.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="æ‹†åˆ†é€‰è¯" Click="SplitWords_Click"/>
                                    <MenuItem Header="{Binding PinMenuText}" Click="TogglePin_Click"/>
                                    <MenuItem Header="åˆ é™¤" Click="DeleteText_Click"/>
                                    <Separator/>
                                    <MenuItem Header="æ¸…ç©ºå…¨éƒ¨" Click="ClearAll_Click"/>
                                </ContextMenu>
                            </Border.ContextMenu>

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- å†…å®¹é¢„è§ˆ -->
                                <Grid Grid.Row="0">
                                    <!-- æ–‡æœ¬å†…å®¹ -->
                                    <TextBlock Text="{Binding CardPreview}"
                                               FontSize="13"
                                               Foreground="#323130"
                                               TextWrapping="Wrap"
                                               LineHeight="18"
                                               MaxHeight="{Binding MaxPreviewHeight}">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Visibility" Value="Visible"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsImage}" Value="True">
                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>

                                    <!-- å›¾ç‰‡å†…å®¹ -->
                                    <StackPanel>
                                        <StackPanel.Style>
                                            <Style TargetType="StackPanel">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsImage}" Value="True">
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </StackPanel.Style>
                                        <Image Source="{Binding Image}"
                                               MaxWidth="200"
                                               MaxHeight="150"
                                               Stretch="Uniform"
                                               HorizontalAlignment="Left"
                                               RenderOptions.BitmapScalingMode="LowQuality"/>
                                        <TextBlock Text="[å›¾ç‰‡]"
                                                   FontSize="13"
                                                   Foreground="#605E5C"
                                                   Margin="0,4,0,0"/>
                                    </StackPanel>
                                </Grid>

                                <!-- å±•å¼€/æŠ˜å æŒ‰é’® -->
                                <Button Grid.Row="1"
                                        Name="ExpandButton"
                                        Content="{Binding ExpandButtonText}"
                                        Visibility="{Binding ShowExpandButton}"
                                        HorizontalAlignment="Left"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Foreground="#0078D4"
                                        FontSize="12"
                                        Margin="0,4,0,0"
                                        Padding="0"
                                        Click="ExpandButton_Click"/>

                                <!-- æ—¶é—´æˆ³å’Œæ“ä½œæŒ‰é’® -->
                                <Grid Grid.Row="2" Margin="0,8,0,0">
                                    <TextBlock Text="{Binding TimeDisplay}"
                                               FontSize="11"
                                               Foreground="#605E5C"
                                               VerticalAlignment="Center"/>

                                    <StackPanel Orientation="Horizontal"
                                                HorizontalAlignment="Right">
                                        <Button Content="{Binding PinIcon}"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                FontSize="12"
                                                Padding="6,4"
                                                Margin="2,0"
                                                ToolTip="{Binding PinTooltip}"
                                                Click="TogglePin_Click"/>
                                        <Button Content="âœ‚ï¸"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                FontSize="12"
                                                Padding="6,4"
                                                Margin="2,0"
                                                ToolTip="æ‹†åˆ†é€‰è¯"
                                                Click="SplitWords_Click">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsImage}" Value="True">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                        <Button Content="ðŸ—‘ï¸"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                FontSize="12"
                                                Padding="6,4"
                                                Margin="2,0"
                                                ToolTip="åˆ é™¤"
                                                Click="DeleteText_Click"/>
                                    </StackPanel>
                                </Grid>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </ScrollViewer>

            <!-- åº•éƒ¨æç¤º - ç›´è§’è®¾è®¡ -->
            <Border Grid.Row="3" Background="White" Padding="16,8"
                    BorderBrush="#E1E1E1" BorderThickness="0,1,0,0">
                <TextBlock Name="StatusTextBlock"
                           Text="çƒ­é”®ï¼šCtrl+Alt+C å‘¼å‡º | Ctrl+Q æ–‡å­—äº¤æ¢ | Ctrl+T AIç¿»è¯‘ | å³é”®ï¼šæ‹†åˆ†é€‰è¯/åˆ é™¤"
                           FontSize="11"
                           Foreground="#605E5C"
                           HorizontalAlignment="Center"/>
            </Border>
        </Grid>
    </Border>
</Window>
